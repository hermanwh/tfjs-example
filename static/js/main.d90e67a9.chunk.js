(this["webpackJsonptfjs-example"]=this["webpackJsonptfjs-example"]||[]).push([[0],{361:function(e,t,n){},363:function(e,t,n){},372:function(e,t){},373:function(e,t){},381:function(e,t){},384:function(e,t){},385:function(e,t){},461:function(e,t,n){"use strict";n.r(t);var r=n(23),a=n(21),s=n.n(a),i=n(162),c=n.n(i),o=(n(361),n(2)),l=n.n(o),d=n(14),h=n(15),u=n(7),b=(n(363),n(319)),j=n.n(b),p=n(246),f=n(18),m=n(495);function O(e,t,n,r){var a=[],s=Object(f.a)({},e,{name:e,type:t});a.sensors=null!==n?Object(p.a)(Object(p.a)({},n.sensors),s):Object(p.a)({},s),a.input=[],a.output=[],a.internal=[],Object.keys(a.sensors).forEach((function(e){return a[a.sensors[e].type].push(a.sensors[e].name)})),r(a)}var x=function(e){var t=Object(a.useState)(!1),n=Object(u.a)(t,2),s=n[0],i=n[1],c=Object(a.useState)(!1),o=Object(u.a)(c,2),l=o[0],d=o[1],h=Object(a.useState)(!1),b=Object(u.a)(h,2),j=b[0],p=b[1],f=function(t){switch(t){case 0:i(!0),d(!1),p(!1),e.func(e.sensor,"input",e.sensorConfig,e.setFunc);break;case 1:d(!0),i(!1),p(!1),e.func(e.sensor,"output",e.sensorConfig,e.setFunc);break;case 2:p(!0),d(!1),i(!1),e.func(e.sensor,"internal",e.sensorConfig,e.setFunc)}};return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:Object(r.jsx)("p",{children:e.sensor})}),Object(r.jsx)("td",{children:Object(r.jsx)(m.a,{color:"default",onClick:function(){return f(0)},checked:s})}),Object(r.jsx)("td",{children:Object(r.jsx)(m.a,{color:"default",onClick:function(){return f(1)},checked:l})}),Object(r.jsx)("td",{children:Object(r.jsx)(m.a,{color:"default",onClick:function(){return f(2)},checked:j})})]})},g=n(71),w=n(343),v=n(349);function k(e,t){for(var n=0,r=0,a=function(a){for(var s=t.map((function(e){return Number(e[a])})),i=e.map((function(e){return Number(e[a])})),c=0,o=0,l=s.reduce((function(e,t){return e+t}),0)/s.length,d=0;d<s.length;d++)c+=Math.pow(s[d]-l,2),o+=Math.pow(i[d]-s[d],2);n+=o,r+=c},s=0;s<t[0].length;s++)a(s);return{SStot:n,SSres:r,rSquared:1-n/r}}function y(e,t,n,r){var a={};return a.trainFeatures=g.tensor2d(e),a.trainTargets=g.tensor2d(n),a.testFeatures=g.tensor2d(t),a.testTargets=g.tensor2d(r),a}function _(e,t,n){var r=function(e){var t=[],n=e[0];return e.slice(1,-1).forEach((function(e,r){var a={};n.forEach((function(t,n){return a[t]=e[n]})),t.push(a)})),t}(e);r=function(e){return e.filter((function(e){return!Object.values(e).some((function(e){return""===e||null==e}))}))}(r);var a=function(e,t){var n=t.input,r=t.output,a=[],s=[];return e.forEach((function(e){var t=[];n.forEach((function(n){t.push(Number(e[n]))})),a.push(t);var i=[];r.forEach((function(t){i.push(Number(e[t]))})),s.push(i)})),[a,s]}(r=Object(v.shuffle)(r),t),s=Object(u.a)(a,2);return function(e,t,n){var r=e.length,a=r-Math.round(r*n);return[e.slice(0,a-1),e.slice(a-1),t.slice(0,a-1),t.slice(a-1)]}(s[0],s[1],n.test_train_split)}var S={batchSize:1024,test_train_split:.2,validation_split:.2,learningRate:.01,epochs:10};var N=function(){var e=Object(a.useState)(1),t=Object(u.a)(e,2),n=t[0],s=t[1],i=Object(a.useState)(null),c=Object(u.a)(i,2),o=c[0],b=c[1],p=Object(a.useState)(null),f=Object(u.a)(p,2),m=f[0],v=f[1],N=Object(a.useState)(null),F=Object(u.a)(N,2),C=F[0],T=F[1],E=Object(a.useState)(-1e3),z=Object(u.a)(E,2),I=z[0],R=z[1],A=Object(a.useState)(!1),B=Object(u.a)(A,2),L=B[0],q=B[1],G=Object(a.useState)(!1),D=Object(u.a)(G,2),M=D[0],U=D[1],H=Object(a.useState)([]),J=Object(u.a)(H,2),P=J[0],V=J[1],Y=Object(a.useState)(null),K=Object(u.a)(Y,2),Q=K[0],W=K[1],X=Object(a.useState)(!1),Z=Object(u.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)(S.epochs),ne=Object(u.a)(te,2),re=ne[0],ae=ne[1],se=Object(a.useState)(S.batchSize),ie=Object(u.a)(se,2),ce=ie[0],oe=ie[1];function le(e){de(),s(2),T(e)}function de(){R(-1e3),q(!1),U(!1),V([]),W(null),ee(!1),ae(S.epochs),oe(S.batchSize),function(){var e=document.getElementById("lossCanvas");for(;e.firstChild;)e.removeChild(e.lastChild)}()}function he(e,t,n,r){return ue.apply(this,arguments)}function ue(){return(ue=Object(h.a)(l.a.mark((function e(t,n,r,a){var s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U(!0),s=y(t,n,r,a),e.next=4,je(s.trainFeatures,s.trainTargets);case 4:i=e.sent,W(i),R(k(i.predict(s.testFeatures).arraySync(),a).rSquared),q(!0),U(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e,t,n,r,a){var s=g.sequential();return s.add(g.layers.dense({kernelRegularizer:g.regularizers.L1L2,units:e[0],activation:r,inputShape:[t]})),e.slice(1).forEach((function(e){s.add(g.layers.dense({kernelRegularizer:g.regularizers.L1L2,units:e,activation:r,inputShape:[e]}))})),s.add(g.layers.dense({units:n,activation:a})),s}function je(e,t){return pe.apply(this,arguments)}function pe(){return(pe=Object(h.a)(l.a.mark((function e(t,n){var r,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=be([128,128],t.shape[1],n.shape[1],"relu","linear")).summary(),r.compile({optimizer:g.train.adam(S.learningRate),loss:"meanAbsoluteError"}),S.batchSize>t.shape[0]&&(oe(32),ae(30)),a=document.getElementById("lossCanvas"),s=w.show.fitCallbacks(a,["loss","val_loss"],{callbacks:["onEpochEnd","onBatchEnd"]}),e.next=8,r.fit(t,n,{batchSize:S.batchSize>t.shape[0]?32:S.batchSize,epochs:S.batchSize>t.shape[0]?30:S.epochs,validationSplit:S.validation_split,callbacks:s});case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(){return(fe=Object(h.a)(l.a.mark((function e(){var t,n,r,a,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(3),t=_(o,C,S),n=Object(u.a)(t,4),r=n[0],a=n[1],i=n[2],c=n[3],V([r,a,i,c]),he(r,a,i,c);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var me=Object(a.useRef)();return Object(a.useEffect)((function(){me.current&&me.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}),[n,M,L,re,Q,C]),Object(r.jsxs)("div",{className:"App",ref:me,children:[Object(r.jsxs)("div",{className:"step",children:[Object(r.jsx)("p",{style:{marginBottom:"20px"},children:"Machine learning demo using TensorFlowJS and React"}),Object(r.jsxs)("p",{className:"midtext",children:["This small web application shows an entry-level example of machine learning performed directly in the browser using"," ",Object(r.jsx)("a",{href:"https://www.tensorflow.org/js",target:"_blank",rel:"noopener noreferrer",children:"TensorFlowJS"})," ","and"," ",Object(r.jsx)("a",{href:"https://reactjs.org/",target:"_blank",rel:"noopener noreferrer",children:"React"}),". A dataset in"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Comma-separated_values",target:"_blank",rel:"noopener noreferrer",children:".csv format"})," ","is parsed to a matrix of strings and converted to"," ",Object(r.jsx)("a",{href:"https://www.tensorflow.org/guide/tensor",target:"_blank",rel:"noopener noreferrer",children:"tensors"}),". Input and output"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Feature_(machine_learning)",target:"_blank",rel:"noopener noreferrer",children:"features"})," ","may be adjusted by the user. A"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Artificial_neural_network",target:"_blank",rel:"noopener noreferrer",children:"neural network"})," ","model with sensible default"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Hyperparameter_(machine_learning)",target:"_blank",rel:"noopener noreferrer",children:"hyperparameters"})," ","and structure is trained.",Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),"For testing, I prepared the following datasets which you are advised to use:",Object(r.jsx)("br",{}),Object(r.jsx)("a",{href:"https://github.com/hermanwh/tfjs-example/blob/main/iris_flower_dataset_extended.csv",target:"_blank",rel:"noopener noreferrer",children:"Iris flower dataset"})," ","(direct download link:"," ",Object(r.jsx)("a",{href:"https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/hermanwh/tfjs-example/blob/main/iris_flower_dataset_extended.csv",target:"_blank",rel:"noopener noreferrer",children:"link1"}),")",Object(r.jsx)("br",{}),Object(r.jsx)("a",{href:"https://github.com/hermanwh/tfjs-example/blob/main/mechanical_component_dataset.csv",target:"_blank",rel:"noopener noreferrer",children:"Hydraulic jack system"})," ","(direct download link:"," ",Object(r.jsx)("a",{href:"https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/hermanwh/tfjs-example/blob/main/mechanical_component_dataset.csv",target:"_blank",rel:"noopener noreferrer",children:"link2"}),").",Object(r.jsx)("br",{}),"Download links from GitHub are created using"," ",Object(r.jsx)("a",{href:"https://minhaskamal.github.io/DownGit",target:"_blank",rel:"noopener noreferrer",children:"https://minhaskamal.github.io/DownGit"}),".",Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),"For implementation details, visit"," ",Object(r.jsx)("a",{href:"https://github.com/hermanwh/tfjs-example",target:"_blank",rel:"noopener noreferrer",children:"the GitHub repository"})]})]}),Object(r.jsxs)("div",{className:"step",children:[n>1?Object(r.jsx)("p",{className:"green",children:"1. Upload dataset in .csv format \xa0 \u2714"}):Object(r.jsx)("p",{children:"1. Upload dataset in .csv format"}),Object(r.jsx)("p",{className:"smalltext",children:"The first row of the file should contain the column headers. The following rows should contain data values. In a program like Excel, this may look something like this:"}),Object(r.jsx)("table",{className:"noPad",children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:"sepal length"}),Object(r.jsx)("td",{children:"sepal width"}),Object(r.jsx)("td",{children:"petal length"}),Object(r.jsx)("td",{children:"petal width"})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:"5.1"}),Object(r.jsx)("td",{children:"3.5"}),Object(r.jsx)("td",{children:"1.4"}),Object(r.jsx)("td",{children:"0.2"})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:"4.9"}),Object(r.jsx)("td",{children:"3.0"}),Object(r.jsx)("td",{children:"1.3"}),Object(r.jsx)("td",{children:"0.3"})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:"...."}),Object(r.jsx)("td",{children:"...."}),Object(r.jsx)("td",{children:"...."}),Object(r.jsx)("td",{children:"...."})]})]})}),Object(r.jsx)(j.a,{cssClass:"react-csv-input",onFileLoaded:function(e){b(e),v(e[0]),T(null),de(),s(2)},onError:function(){return ee(!0)}}),$&&Object(r.jsx)("p",{children:".csv upload failed, please try again"})]}),n>1&&Object(r.jsxs)("div",{className:"step",children:[n>2?Object(r.jsx)("p",{className:"green",children:"2. Choose input and output features \xa0 \u2714"}):Object(r.jsx)("p",{children:"2. Choose input and output features"}),Object(r.jsx)("p",{className:"smalltext",children:'Any number of input features can be used to predict any number of output features. Irrelevant dataset columns, such as time or index columns, may be excluded. Features with no selected value are ignored. If you have provided a personal .csv file and features are not listed in the "feature names" column as expected, the provided file has the wrong formatting and cannot be used with this specific application, unfortunately.'}),null!=m&&Object(r.jsx)("div",{children:Object(r.jsx)("table",{children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{className:"TableField",children:"Feature name"}),Object(r.jsx)("th",{className:"TableField",children:"Input"}),Object(r.jsx)("th",{className:"TableField",children:"Output"}),Object(r.jsx)("th",{className:"TableField",children:"Exclude"})]}),m&&m.map((function(e){return Object(r.jsx)(x,{sensor:e,func:O,sensorConfig:C,setFunc:le},e)}))]})})})]}),n>1&&null!=C&&C.input.length>0&&C.output.length>0&&Object(r.jsxs)("div",{className:"step",children:[L?Object(r.jsx)("p",{className:"green",children:"3. Train your neural network model \xa0 \u2714"}):Object(r.jsx)("p",{children:"3. Train your neural network model"}),Object(r.jsxs)("p",{className:"smalltext",children:["By default, the defined model is a"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Artificial_neural_network#Organization",target:"_blank",rel:"noopener noreferrer",children:"fully connected"})," ","neural network consisting of an input layer, two"," ",Object(r.jsx)("a",{href:"https://deepai.org/machine-learning-glossary-and-terms/hidden-layer-machine-learning",target:"_blank",rel:"noopener noreferrer",children:"hidden layers"})," ","of 128"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Artificial_neuron",target:"_blank",rel:"noopener noreferrer",children:"neurons or units"})," ","each, and an output layer. A"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Rectifier_(neural_networks)",target:"_blank",rel:"noopener noreferrer",children:"ReLU"})," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Activation_function",target:"_blank",rel:"noopener noreferrer",children:"activation function"})," ","is used in the hidden neurons, while a linear activation is used at the output. The"," ",Object(r.jsx)("a",{href:"https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/",target:"_blank",rel:"noopener noreferrer",children:"Adam optimizer"})," ","is used, as well as the"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Mean_absolute_error",target:"_blank",rel:"noopener noreferrer",children:"mean absolute error"})," ","metric."]}),Object(r.jsx)("button",{className:"react-csv-input",onClick:function(){return fe.apply(this,arguments)},children:"Start model training"})]}),Object(r.jsxs)("div",{className:"step",style:{paddingTop:"0px"},children:[Object(r.jsxs)("div",{children:[n>2&&Object(r.jsxs)("p",{className:"smalltext",children:["The model is trained for ",re," epochs in batches of ",ce,". Epochs are the number of loops over the entirely training data. Batch size is the number of dataset rows used to calculate the stochastic gradient and perform weight updates. The figures below are updated with the calculated training and validation error metric when a batch or epoch is finished, respectively."]}),Object(r.jsx)("div",{className:"canvases",id:"lossCanvas"})]}),L&&Object(r.jsxs)("div",{children:[Object(r.jsxs)("p",{children:["R-squared score: ",I.toFixed(5)]}),Object(r.jsxs)("p",{className:"smalltext",children:["The"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Coefficient_of_determination",target:"_blank",rel:"noopener noreferrer",children:"R-squared metric"})," ","is a measure of how well observed outcomes are replicated by the model. 1.0 means perfect replication, while anything above 0.0 indicates the model performed better than a mean predictor."]}),Object(r.jsx)("button",{className:"buttonStyle",onClick:function(){return he.apply(void 0,Object(d.a)(P))},children:"Retrain model"}),Object(r.jsxs)("div",{className:"step",children:[Object(r.jsx)("p",{children:"So what now?"}),Object(r.jsxs)("p",{className:"smalltext",children:["Good question! Usually, the trained model would be evaluated based on some metrics (R-squared is one such metric), and perhaps even using empirical analysis and expert knowledge. If deemed suitable, the model may be used to make predictions on new, future data samples. The difference between measured and predicted value can be used to derive fault models, e.g. indicating component health in a mechanical or industrial system. Using machine learning models in practice is a large and active area of research. You can read about an attempt at using neural network models for condition monitoring for the oil and gas industry in"," ",Object(r.jsx)("a",{href:"https://github.com/hermanwh/master-thesis",target:"_blank",rel:"noopener noreferrer",children:"my master thesis"}),"."]})]})]})]})]})};var F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,496)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),s(e),i(e)}))};c.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(N,{})}),document.getElementById("root")),F()}},[[461,1,2]]]);
//# sourceMappingURL=main.d90e67a9.chunk.js.map
(this["webpackJsonptfjs-example"]=this["webpackJsonptfjs-example"]||[]).push([[0],{361:function(e,t,n){},363:function(e,t,n){},372:function(e,t){},373:function(e,t){},381:function(e,t){},384:function(e,t){},385:function(e,t){},461:function(e,t,n){"use strict";n.r(t);var s=n(36),a=n(21),r=n.n(a),c=n(163),i=n.n(c),o=(n(361),n(2)),u=n.n(o),l=n(14),d=n(15),j=n(7),h=(n(363),n(320)),b=n.n(h),p=n(263),f=n(18),m=n(495);function O(e,t,n,s){var a=[],r=Object(f.a)({},e,{name:e,type:t});a.sensors=null!==n?Object(p.a)(Object(p.a)({},n.sensors),r):[],a.input=[],a.output=[],a.internal=[],Object.keys(a.sensors).forEach((function(e){return a[a.sensors[e].type].push(a.sensors[e].name)})),s(a)}var x=function(e){var t=Object(a.useState)(!1),n=Object(j.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(!1),o=Object(j.a)(i,2),u=o[0],l=o[1],d=Object(a.useState)(!1),h=Object(j.a)(d,2),b=h[0],p=h[1],f=function(t){switch(t){case 0:c(!0),l(!1),p(!1),e.func(e.sensor,"input",e.sensorConfig,e.setFunc);break;case 1:l(!0),c(!1),p(!1),e.func(e.sensor,"output",e.sensorConfig,e.setFunc);break;case 2:p(!0),l(!1),c(!1),e.func(e.sensor,"internal",e.sensorConfig,e.setFunc)}};return Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:Object(s.jsx)("p",{children:e.sensor})}),Object(s.jsx)("td",{children:Object(s.jsx)(m.a,{color:"default",onClick:function(){return f(0)},checked:r})}),Object(s.jsx)("td",{children:Object(s.jsx)(m.a,{color:"default",onClick:function(){return f(1)},checked:u})}),Object(s.jsx)("td",{children:Object(s.jsx)(m.a,{color:"default",onClick:function(){return f(2)},checked:b})})]})},v=n(71),g=n(344),w=n(137);function S(e,t){t=t.map((function(e){return Number(e)})),e=e.map((function(e){return Number(e)}));for(var n=0,s=0,a=0,r=0;r<t.length;r++)n+=t[r];n/=t.length;for(var c=0;c<t.length;c++)s+=Math.pow(t[c]-n,2),a+=Math.pow(e[c]-t[c],2);return{meanValue:n,SStot:s,SSres:a,rSquared:1-a/s}}function y(e,t,n,s){var a={};return a.trainFeatures=v.tensor2d(e),a.trainTargets=v.tensor2d(n),a.testFeatures=v.tensor2d(t),a.testTargets=v.tensor2d(s),a}function k(e,t,n){var s=function(e){var t=[],n=e[0];return e.slice(1,-1).forEach((function(e,s){var a={};n.forEach((function(t,n){return a[t]=e[n]})),t.push(a)})),t}(e),a=function(e,t){var n=t.input,s=e.map((function(e){return[Number(e[t.output[0]])]})),a=[];return e.forEach((function(e){var t=[];n.forEach((function(n){t.push(Number(e[n]))})),a.push(t)})),[a,s]}(s=function(e){return Object(w.shuffle)(e)}(s=function(e){return e.filter((function(e){return!Object.values(e).some((function(e){return""===e||null==e}))}))}(s)),t),r=Object(j.a)(a,2);return function(e,t,n){var s=e.length,a=s-Math.round(s*n);return[e.slice(0,a-1),e.slice(a-1),t.slice(0,a-1),t.slice(a-1)]}(r[0],r[1],n.test_train_split)}function N(e,t,n,s,a){var r=v.sequential();return r.add(v.layers.dense({kernelRegularizer:v.regularizers.L1L2,units:e[0],activation:s,inputShape:[t]})),e.slice(1).forEach((function(e){r.add(v.layers.dense({kernelRegularizer:v.regularizers.L1L2,units:e,activation:s,inputShape:[e]}))})),r.add(v.layers.dense({units:n,activation:a})),r}var F={batchSize:1024,test_train_split:.2,validation_split:.2,learningRate:.01,epochs:10,optimizer:v.train.adam(.01),loss:"meanAbsoluteError",min_R2_score:.5,max_iterations:4};var C=function(){var e=Object(a.useState)(1),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),i=Object(j.a)(c,2),o=i[0],h=i[1],p=Object(a.useState)(null),f=Object(j.a)(p,2),m=f[0],v=f[1],w=Object(a.useState)(!1),C=Object(j.a)(w,2),T=(C[0],C[1]),z=Object(a.useState)(null),E=Object(j.a)(z,2),_=E[0],R=E[1],I=Object(a.useState)(-1e3),L=Object(j.a)(I,2),q=L[0],A=L[1],B=Object(a.useState)(!1),M=Object(j.a)(B,2),J=M[0],P=M[1],U=Object(a.useState)(!1),D=Object(j.a)(U,2),G=(D[0],D[1]),H=Object(a.useState)([]),V=Object(j.a)(H,2),K=V[0],Q=V[1],W=Object(a.useState)(null),X=Object(j.a)(W,2),Y=(X[0],X[1]),Z=Object(a.useState)(F.epochs),$=Object(j.a)(Z,2),ee=$[0],te=$[1],ne=Object(a.useState)(F.batchSize),se=Object(j.a)(ne,2),ae=se[0],re=se[1];function ce(e,t,n,s){return ie.apply(this,arguments)}function ie(){return(ie=Object(d.a)(u.a.mark((function e(t,n,s,a){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G(!0),r=y(t,n,s,a),e.next=4,oe(r.trainFeatures,r.trainTargets);case 4:c=e.sent,Y(c),A(S(c.predict(r.testFeatures).arraySync(),a).rSquared),P(!0),G(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e,t){return ue.apply(this,arguments)}function ue(){return(ue=Object(d.a)(u.a.mark((function e(t,n){var s,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=N([128,128],t.shape[1],n.shape[1],"relu","linear")).summary(),s.compile({optimizer:F.optimizer,loss:F.loss}),F.batchSize>t.shape[0]&&(re(32),te(30)),a=document.getElementById("lossCanvas"),r=g.show.fitCallbacks(a,["loss","val_loss"],{callbacks:["onEpochEnd","onBatchEnd"]}),e.next=8,s.fit(t,n,{batchSize:F.batchSize>t.shape[0]?32:F.batchSize,epochs:F.batchSize>t.shape[0]?30:F.epochs,validationSplit:F.validation_split,callbacks:r});case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(){return(le=Object(d.a)(u.a.mark((function e(){var t,n,s,a,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(3),t=k(o,_,F),n=Object(j.a)(t,4),s=n[0],a=n[1],c=n[2],i=n[3],Q([s,a,c,i]),ce(s,a,c,i);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsx)("div",{className:"step",children:Object(s.jsxs)("p",{className:"midtext",children:["This small web application shows an entry-level example of machine learning performed directly in the browser using"," ",Object(s.jsx)("a",{href:"https://www.tensorflow.org/js",children:"TensorFlowJS"})," and"," ",Object(s.jsx)("a",{href:"https://reactjs.org/",children:"React"}),". A dataset in"," ",Object(s.jsx)("a",{href:"https://en.wikipedia.org/wiki/Comma-separated_values",children:".csv format"})," ","is parsed to a matrix of strings and converted to"," ",Object(s.jsx)("a",{href:"https://www.tensorflow.org/guide/tensor",children:"tensors"}),". Input and output features may be adjusted by the user. A neural network model with sensible default hyperparameters and structure is trained.",Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),"For implementation details, visit"," ",Object(s.jsx)("a",{href:"https://github.com/hermanwh/tfjs-example",children:"the GitHub repository"})]})}),Object(s.jsxs)("div",{className:"step",children:[n>1?Object(s.jsx)("p",{className:"green",children:"1. Upload dataset in .csv format \xa0 \u2714"}):Object(s.jsx)("p",{children:"1. Upload dataset in .csv format"}),Object(s.jsx)("p",{className:"smalltext",children:"The first row of the file should contain the column headers. The following rows should contain data values."}),Object(s.jsx)(b.a,{cssClass:"react-csv-input",onFileLoaded:function(e){T(!0),h(e),v(e[0]),r(2)}})]}),n>1&&Object(s.jsxs)("div",{className:"step",children:[n>2?Object(s.jsx)("p",{className:"green",children:"2. Choose input and output features \xa0 \u2714"}):Object(s.jsx)("p",{children:"2. Choose input and output features"}),Object(s.jsx)("p",{className:"smalltext",children:"Any number of input features can be used to predict any number of output features. Irrelevant dataset columns, e.g. time or index columns, may be excluded. Features with no selected value are ignored."}),null!=m&&Object(s.jsx)("div",{children:Object(s.jsx)("table",{children:Object(s.jsxs)("tbody",{children:[Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{className:"TableField",children:"Feature name"}),Object(s.jsx)("th",{className:"TableField",children:"Input"}),Object(s.jsx)("th",{className:"TableField",children:"Output"}),Object(s.jsx)("th",{className:"TableField",children:"Exclude"})]}),m&&m.map((function(e){return Object(s.jsx)(x,{sensor:e,func:O,sensorConfig:_,setFunc:R},e)}))]})})})]}),n>1&&Object(s.jsxs)("div",{className:"step",children:[J?Object(s.jsx)("p",{className:"green",children:"3. Train your neural network model \xa0 \u2714"}):Object(s.jsx)("p",{children:"3. Train your neural network model"}),Object(s.jsx)("button",{className:"react-csv-input",onClick:function(){return le.apply(this,arguments)},children:"Init model training"})]}),Object(s.jsxs)("div",{className:"step",style:{paddingTop:"0px"},children:[Object(s.jsxs)("div",{children:[n>2&&Object(s.jsxs)("p",{className:"smalltext",children:["The model is being trained for ",ee," epochs in batches of"," ",ae,"."]}),Object(s.jsx)("div",{className:"canvases",id:"lossCanvas"})]}),J&&Object(s.jsxs)("div",{children:[Object(s.jsxs)("p",{children:["R-squared score: ",q.toFixed(5)]}),Object(s.jsxs)("p",{className:"smalltext",children:["The"," ",Object(s.jsx)("a",{href:"https://en.wikipedia.org/wiki/Coefficient_of_determination",children:"R-squared metric"})," ","is a measure of how well observed outcomes are replicated by the model. 1.0 means perfect replication, while anything above 0.0 indicates the model performed better than a mean predictor."]}),Object(s.jsx)("button",{className:"buttonStyle",onClick:function(){return ce.apply(void 0,Object(l.a)(K))},children:"Retrain model"})]})]})]})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,496)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),s(e),a(e),r(e),c(e)}))};i.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(C,{})}),document.getElementById("root")),T()}},[[461,1,2]]]);
//# sourceMappingURL=main.6c9959d4.chunk.js.map
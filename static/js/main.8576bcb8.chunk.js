(this["webpackJsonptfjs-example"]=this["webpackJsonptfjs-example"]||[]).push([[0],{361:function(e,t,n){},363:function(e,t,n){},372:function(e,t){},373:function(e,t){},381:function(e,t){},384:function(e,t){},385:function(e,t){},461:function(e,t,n){"use strict";n.r(t);var s=n(42),c=n(21),r=n.n(c),a=n(163),i=n.n(a),u=(n(361),n(2)),o=n.n(u),l=n(14),j=n(15),b=n(7),d=(n(363),n(320)),p=n.n(d),f=n(263),h=n(18),O=n(495);function m(e,t,n,s){var c=[],r=Object(h.a)({},e,{name:e,type:t});c.sensors=null!==n?Object(f.a)(Object(f.a)({},n.sensors),r):[],c.input=[],c.output=[],c.internal=[],Object.keys(c.sensors).forEach((function(e){return c[c.sensors[e].type].push(c.sensors[e].name)})),s(c)}var v=function(e){var t=Object(c.useState)(!1),n=Object(b.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(!1),u=Object(b.a)(i,2),o=u[0],l=u[1],j=Object(c.useState)(!1),d=Object(b.a)(j,2),p=d[0],f=d[1],h=function(t){switch(t){case 0:a(!0),l(!1),f(!1),e.func(e.sensor,"input",e.sensorConfig,e.setFunc);break;case 1:l(!0),a(!1),f(!1),e.func(e.sensor,"output",e.sensorConfig,e.setFunc);break;case 2:f(!0),l(!1),a(!1),e.func(e.sensor,"internal",e.sensorConfig,e.setFunc)}};return Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:Object(s.jsx)("p",{children:e.sensor})}),Object(s.jsx)("td",{children:Object(s.jsx)(O.a,{color:"default",onClick:function(){return h(0)},checked:r})}),Object(s.jsx)("td",{children:Object(s.jsx)(O.a,{color:"default",onClick:function(){return h(1)},checked:o})}),Object(s.jsx)("td",{children:Object(s.jsx)(O.a,{color:"default",onClick:function(){return h(2)},checked:p})})]})},x=n(81),S=n(344),g=n(137);function k(e,t){t=t.map((function(e){return Number(e)})),e=e.map((function(e){return Number(e)}));for(var n=0,s=0,c=0,r=0;r<t.length;r++)n+=t[r];n/=t.length;for(var a=0;a<t.length;a++)s+=Math.pow(t[a]-n,2),c+=Math.pow(e[a]-t[a],2);return{meanValue:n,SStot:s,SSres:c,rSquared:1-c/s}}function y(e,t,n,s){var c={};return c.trainFeatures=x.tensor2d(e),c.trainTargets=x.tensor2d(n),c.testFeatures=x.tensor2d(t),c.testTargets=x.tensor2d(s),c}function F(e,t,n){var s=function(e){var t=[],n=e[0];return e.slice(1,-1).forEach((function(e,s){var c={};n.forEach((function(t,n){return c[t]=e[n]})),t.push(c)})),t}(e),c=function(e,t){var n=t.input,s=e.map((function(e){return[Number(e[t.output[0]])]})),c=[];return e.forEach((function(e){var t=[];n.forEach((function(n){t.push(Number(e[n]))})),c.push(t)})),[c,s]}(s=function(e){return Object(g.shuffle)(e)}(s=function(e){return e.filter((function(e){return!Object.values(e).some((function(e){return""===e||null==e}))}))}(s)),t),r=Object(b.a)(c,2);return function(e,t,n){var s=e.length,c=s-Math.round(s*n);return[e.slice(0,c-1),e.slice(c-1),t.slice(0,c-1),t.slice(c-1)]}(r[0],r[1],n.test_train_split)}function C(e,t,n,s,c){var r=x.sequential();return e.forEach((function(e){r.add(x.layers.dense({kernelRegularizer:x.regularizers.L1L2,units:e,activation:s,inputShape:[t]}))})),r.add(x.layers.dense({units:n,activation:c})),r}var N={batchSize:512,test_train_split:.2,validation_split:.2,learningRate:.01,epochs:200,optimizer:x.train.adam(.01),loss:"meanAbsoluteError",min_R2_score:.5,max_iterations:4};var E=function(){var e=Object(c.useState)(null),t=Object(b.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(null),i=Object(b.a)(a,2),u=i[0],d=i[1],f=Object(c.useState)(!1),h=Object(b.a)(f,2),O=(h[0],h[1]),x=Object(c.useState)(null),g=Object(b.a)(x,2),E=g[0],w=g[1],T=Object(c.useState)(-1e3),_=Object(b.a)(T,2),z=_[0],L=_[1],I=Object(c.useState)(!1),M=Object(b.a)(I,2),R=M[0],q=M[1],B=Object(c.useState)(!1),A=Object(b.a)(B,2),J=(A[0],A[1]),P=Object(c.useState)([]),D=Object(b.a)(P,2),U=D[0],V=D[1],G=Object(c.useState)(null),H=Object(b.a)(G,2),K=(H[0],H[1]);function Q(e,t,n,s){return W.apply(this,arguments)}function W(){return(W=Object(j.a)(o.a.mark((function e(t,n,s,c){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(!0),r=y(t,n,s,c),e.next=4,X(r.trainFeatures,r.trainTargets);case 4:a=e.sent,K(a),L(k(a.predict(r.testFeatures).arraySync(),c).rSquared),q(!0),J(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t){return Y.apply(this,arguments)}function Y(){return(Y=Object(j.a)(o.a.mark((function e(t,n){var s,c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=C([128],t.shape[1],n.shape[1],"relu","linear"),console.log("Model:",s.summary()),s.summary(),s.compile({optimizer:N.optimizer,loss:N.loss}),c=document.getElementById("lossCanvas"),r=S.show.fitCallbacks(c,["loss","val_loss"],{callbacks:["onEpochEnd","onBatchEnd"]}),e.next=8,s.fit(t,n,{batchSize:N.batchSize,epochs:N.epochs,validationSplit:N.validation_split,callbacks:r});case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return(Z=Object(j.a)(o.a.mark((function e(){var t,s,c,r,a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=F(n,E,N),s=Object(b.a)(t,4),c=s[0],r=s[1],a=s[2],i=s[3],V([c,r,a,i]),Q(c,r,a,i);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsxs)("div",{className:"step",children:[Object(s.jsx)("p",{children:"Step 1: Upload dataset in .csv format"}),Object(s.jsx)(p.a,{cssClass:"react-csv-input",onFileLoaded:function(e){O(!0),r(e),d(e[0])}})]}),Object(s.jsxs)("div",{className:"step",children:[Object(s.jsx)("p",{children:"Step 2: Choose values for sensors"}),null!=u&&Object(s.jsx)("table",{children:Object(s.jsxs)("tbody",{children:[Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{className:"TableField",children:"Sensor name"}),Object(s.jsx)("th",{className:"TableField",children:"Input"}),Object(s.jsx)("th",{className:"TableField",children:"Output"}),Object(s.jsx)("th",{className:"TableField",children:"Exclude"})]}),u&&u.map((function(e){return Object(s.jsx)(v,{sensor:e,func:m,sensorConfig:E,setFunc:w},e)}))]})})]}),Object(s.jsxs)("div",{className:"step",children:[Object(s.jsx)("p",{children:"Step 3: Train model"}),Object(s.jsx)("button",{className:"react-csv-input",onClick:function(){return Z.apply(this,arguments)},children:"Init model training"}),Object(s.jsxs)("div",{children:[Object(s.jsx)("h4",{children:"Loss"}),Object(s.jsx)("div",{className:"canvases",id:"lossCanvas"})]}),R&&Object(s.jsxs)("div",{children:[Object(s.jsxs)("p",{children:["R-squared score: ",z.toFixed(5)]}),Object(s.jsx)("button",{className:"buttonStyle",onClick:function(){return Q.apply(void 0,Object(l.a)(U))},children:"Retrain model"})]})]})]})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,496)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),s(e),c(e),r(e),a(e)}))};i.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(E,{})}),document.getElementById("root")),w()}},[[461,1,2]]]);
//# sourceMappingURL=main.8576bcb8.chunk.js.map